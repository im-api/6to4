# اسکریپت مدیریت تونل

این اسکریپت قابلیت‌هایی برای مدیریت تونل‌های 6to4 در سیستم‌های لینوکس فراهم می‌آورد. این اسکریپت شامل ایجاد، لیست کردن و حذف تونل‌ها، همچنین پایدار کردن تنظیمات تونل و پیکربندی سرویس `rc-local` برای راه‌اندازی سیستم است.

## ویژگی‌ها

- **ایجاد تونل**: افزودن تونل جدید 6to4 با آدرس‌های IPv4 و IPv6 مشخص.
- **لیست کردن تونل‌ها**: نمایش تمام تونل‌های فعال 6to4.
- **حذف تونل**: حذف یک تونل موجود.
- **پایدار کردن تنظیمات**: ذخیره تنظیمات تونل در `/etc/rc.local` برای پایدار بودن در طول راه‌اندازی مجدد.
- **پیکربندی سرویس `rc-local`**: راه‌اندازی سرویس `rc-local` برای اطمینان از اجرای `/etc/rc.local` در راه‌اندازی سیستم.

## پیش‌نیازها

- سیستم لینوکسی با نصب ابزارهای `bash`، `ip`، و `systemctl`.
- دسترسی ریشه (root) برای تغییر `/etc/rc.local` و ایجاد سرویس‌های systemd.

## نحوه استفاده

### 1. **دریافت آدرس IPv6**

برای ایجاد تونل 6to4، به یک آدرس IPv6 منحصر به فرد نیاز دارید. مراحل زیر را دنبال کنید:

1. به [تولیدکننده آدرس IPv6 منحصر به فرد](https://www.unique-local-ipv6.com) مراجعه کنید.
2. یک آدرس IPv6 منحصر به فرد تولید کنید.
3. آدرس IPv6 تولید شده را کپی کنید. از این آدرس برای پیکربندی تونل استفاده خواهید کرد.

### 2. **اجرای اسکریپت به طور مستقیم**

برای دانلود و اجرای اسکریپت، دستور زیر را اجرا کنید:

```bash
bash <(curl -H 'Cache-Control: no-cache' -sSL "https://raw.githubusercontent.com/im-api/6to4/main/6to4.sh?$(date +%s)" --ipv4)
```
3. گزینه‌های منو
هنگام اجرای اسکریپت، منویی با گزینه‌های زیر خواهید دید:

ایران: ایجاد یک تونل جدید با تنظیمات پیش‌فرض برای ایران.
خارجی: ایجاد یک تونل جدید با تنظیمات سفارشی برای نام منحصر به فرد.
لیست تونل‌ها: نمایش لیست تمام تونل‌های فعال.
حذف تونل: حذف یک تونل موجود.
پایدار کردن تونل: ذخیره تنظیمات تونل در /etc/rc.local.
پیکربندی سرویس rc-local: ایجاد یا پیکربندی سرویس rc-local برای راه‌اندازی سیستم.
خروج: خروج از اسکریپت.
4. ایجاد تونل
گزینه 1: ایران
انتخاب گزینه 1: انتخاب "ایران" برای ایجاد یک تونل جدید با تنظیمات پیش‌فرض.
ورود جزئیات: آدرس IPv4 محلی، آدرس IPv4 راه دور و آدرس IPv6 پایه‌ای که دریافت کرده‌اید را وارد کنید.
مثال:
آدرس IPv4 محلی: 192.168.1.2
آدرس IPv4 راه دور: 198.51.100.1
آدرس IPv6 پایه: fdcc:c4da:bc9b::
تأیید: اسکریپت یک آدرس IPv6 منحصر به فرد تولید کرده و تونل را ایجاد خواهد کرد.
گزینه 2: خارجی
انتخاب گزینه 2: انتخاب "خارجی" برای ایجاد تونل با تنظیمات سفارشی.
ورود جزئیات: آدرس IPv4 محلی، آدرس IPv4 راه دور، آدرس IPv6 پایه و نام منحصر به فردی برای رابط را وارد کنید.
مثال:
آدرس IPv4 محلی: 192.168.1.2
آدرس IPv4 راه دور: 198.51.100.1
آدرس IPv6 پایه: fdcc:c4da:bc9b::
نام رابط: custom_tunnel
تأیید: اسکریپت تونل را با جزئیات ارائه شده ایجاد خواهد کرد.
5. لیست کردن تونل‌ها
انتخاب گزینه 3: انتخاب "لیست تونل‌ها" برای نمایش تمام تونل‌های فعال 6to4.
6. حذف تونل
انتخاب گزینه 4: انتخاب "حذف تونل" برای حذف یک تونل موجود.
انتخاب تونل: اسکریپت تونل‌های موجود را لیست می‌کند. نام تونلی که می‌خواهید حذف کنید را وارد کنید.
تأیید: اسکریپت از شما تأیید می‌خواهد قبل از حذف تونل.
7. پایدار کردن تونل
انتخاب گزینه 5: انتخاب "پایدار کردن تونل" برای ذخیره تنظیمات تونل در /etc/rc.local.
انتخاب تونل: اسکریپت تونل‌های موجود را لیست می‌کند. نام تونلی که می‌خواهید پایدار کنید را وارد کنید.
تأیید: اسکریپت /etc/rc.local را با تنظیمات تونل به‌روزرسانی خواهد کرد.
8. پیکربندی سرویس rc-local
انتخاب گزینه 6: انتخاب "پیکربندی سرویس rc-local" برای راه‌اندازی سرویس rc-local.
بررسی و ایجاد سرویس: اسکریپت بررسی می‌کند که آیا فایل سرویس rc-local وجود دارد یا خیر. اگر وجود نداشته باشد، آن را ایجاد و پیکربندی می‌کند.
بارگذاری مجدد و راه‌اندازی سرویس: اسکریپت سرویس rc-local را بارگذاری و راه‌اندازی می‌کند تا اطمینان حاصل شود که /etc/rc.local در زمان راه‌اندازی اجرا می‌شود.
9. خروج از اسکریپت
انتخاب گزینه 7: انتخاب "خروج" برای بستن اسکریپت.
یادداشت‌ها
اطمینان حاصل کنید که فایل /etc/rc.local اجرایی است. اسکریپت سعی خواهد کرد آن را در صورت عدم وجود ایجاد کند.
اسکریپت شامل پرسش‌های لازم و تأییدات برای اطمینان از عملیات صحیح است.